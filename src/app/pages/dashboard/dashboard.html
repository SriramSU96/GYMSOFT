<div class="page-header">
    <div>
        <h1 class="page-title">Performance Overview</h1>
        <p class="page-subtitle">Summary of your gym's key metrics and member activity.</p>
    </div>
    <div class="page-actions">
        <button class="btn btn-secondary" (click)="exportReport()">
            <span class="material-icons">download</span>
            <span>Export Report</span>
        </button>
    </div>
</div>

<div class="grid grid-cols-3 gap-lg mb-xl" *ngIf="analytics$ | async as stats">
    <div class="card stat-card">
        <div class="stat-icon">
            <span class="material-icons">people</span>
        </div>
        <div>
            <div class="text-sm text-muted">Active Members</div>
            <div class="text-2xl font-bold">{{ stats.overview?.activeCount || 0 }}</div>
            <div class="text-xs text-success flex items-center mt-xs">
                <span class="material-icons" style="font-size: 1rem;">trending_up</span>
                <span>+12% from last month</span>
            </div>
        </div>
    </div>

    <div class="card stat-card">
        <div class="stat-icon" style="background-color: rgba(52, 211, 153, 0.1); color: #34d399;">
            <span class="material-icons">today</span>
        </div>
        <div>
            <div class="text-sm text-muted">Daily Attendance</div>
            <div class="text-2xl font-bold">{{ stats.overview?.totalMembers || 0 }}</div>
            <div class="text-xs text-muted mt-xs">Based on current check-ins</div>
        </div>
    </div>

    <div class="card stat-card">
        <div class="stat-icon" style="background-color: rgba(251, 191, 36, 0.1); color: #fbbf24;">
            <span class="material-icons">payments</span>
        </div>
        <div>
            <div class="text-sm text-muted">Monthly Revenue</div>
            <div class="text-2xl font-bold">${{ stats.overview?.netProfit || 0 | number:'1.2-2' }}</div>
            <div class="text-xs text-muted mt-xs">Projected current month</div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h3 class="card-title">Analytics Trends</h3>
        <div class="flex gap-sm">
            <button class="btn btn-sm" [class.btn-primary]="activePeriod === 'Day'"
                [class.btn-secondary]="activePeriod !== 'Day'" (click)="setPeriod('Day')">Day</button>
            <button class="btn btn-sm" [class.btn-primary]="activePeriod === 'Week'"
                [class.btn-secondary]="activePeriod !== 'Week'" (click)="setPeriod('Week')">Week</button>
            <button class="btn btn-sm" [class.btn-primary]="activePeriod === 'Month'"
                [class.btn-secondary]="activePeriod !== 'Month'" (click)="setPeriod('Month')">Month</button>
        </div>
    </div>
    <div style="height: 380px; width: 100%; padding: var(--space-md);">
        <canvas baseChart [data]="barChartData" [options]="barChartOptions" [type]="barChartType">
        </canvas>
    </div>
</div>