<div>
    <!-- Action Bar -->
    <div>
        <div>
            <h2>Invoice Detail</h2>
            <p>View and download transaction receipt.</p>
        </div>
        <div>
            <button (click)="printInvoice()">
                <span>print</span>
                <span>Print Invoice</span>
            </button>
            <button (click)="downloadPdf()">
                <span>download</span>
                <span>Download PDF</span>
            </button>
        </div>
    </div>

    <!-- Error State -->
    <div *ngIf="error$ | async as error">
        <span>error_outline</span>
        <h3>Failed to load invoice</h3>
        <p>{{ error.message || 'The requested invoice could not be retrieved.' }}</p>
        <button (click)="ngOnInit()">Try Again</button>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading$ | async">
        <div>refresh</div>
        <p>Generating invoice preview...</p>
    </div>

    <!-- Invoice Content -->
    <div *ngIf="invoice$ | async as invoice">

        <div></div>

        <!-- Header -->
        <div>
            <div>
                <div>
                    <div>
                        <span>fitness_center</span>
                    </div>
                    <h1>GYMSOFT</h1>
                </div>
                <div>
                    <p>123 Fitness Avenue, Tech Hub</p>
                    <p>Silicon Valley, CA 94043</p>
                    <p>billing@gymsoft.com</p>
                </div>
            </div>
            <div>
                <h2>Invoice</h2>
                <div>#{{ invoice._id }}</div>
                <div>
                    <div>Date: <span>{{ invoice.date | date:'mediumDate' }}</span></div>
                    <div>
                        <span class="badge badge-success">
                            PAID
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Billing Info Grid -->
        <div>
            <div>
                <div>Client Details:</div>
                <div>Member ID: {{ invoice.memberId }}</div>
                <div>
                    <p>Plan: {{ invoice.planId }}</p>
                    <p>ID: {{ invoice.memberId }}</p>
                </div>
            </div>
            <div>
                <div>Payment Summary:</div>
                <div>Membership Payment</div>
                <div>System Generated Invoice</div>
            </div>
        </div>

        <!-- Items Table -->
        <div>
            <table>
                <thead>
                    <tr>
                        <th>
                            Description</th>
                        <th>Qty</th>
                        <th>Unit
                            Price</th>
                        <th>Total
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{{ invoice.planId }}</td>
                        <td class="text-right">1</td>
                        <td class="text-right">₹{{ invoice.amount | number }}</td>
                        <td class="text-right">₹{{ invoice.amount | number }}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Calculation Grid -->
        <div>
            <div>
                <div>
                    <span>Subtotal</span>
                    <span>₹{{ invoice.amount | number }}</span>
                </div>
                <div>
                    <span>Estimated Tax (18%)</span>
                    <span>₹{{ (invoice.tax || (invoice.amount * 0.18)) | number }}</span>
                </div>
                <div>
                    <div>Grand Total</div>
                    <div>
                        ₹{{ (invoice.total || (invoice.amount * 1.18)) | number }}
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes & Signature -->
        <div>
            <div>
                <div>Notes:</div>
                <p>Please keep this invoice for your records. Contact
                    billing@gymsoft.com for any discrepancies within 7 days.</p>
            </div>
            <div>
                <div>
                    <div>GymSoft Admin</div>
                </div>
                <div>Authorized Signatory</div>
            </div>
        </div>
    </div>
</div>

<style>
    @media print {
        .no-print {
            display: none !important;
        }

        .page-container {
            padding: 0 !important;
            margin: 0 !important;
        }

        .card.invoice-paper {
            box-shadow: none !important;
            border: 1px solid #ddd !important;
            width: 100% !important;
            max-width: 100% !important;
            color: black !important;
            background: white !important;
        }

        .text-primary,
        .text-accent,
        .text-muted,
        .text-secondary {
            color: black !important;
        }

        .bg-card {
            background: white !important;
        }

        .badge {
            border: 1px solid #000 !important;
            color: black !important;
            background: transparent !important;
        }

        .invoice-accent-bar {
            display: none;
        }

        * {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }
    }
</style>