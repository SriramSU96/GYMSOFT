<div>

    <!-- Header & Controls -->
    <div>
        <div>
            <h2>Profit & Loss Report</h2>
            <p>Financial overview for your gym</p>
        </div>
        <div>
            <select (change)="onMonthChange($event)">
                <option *ngFor="let m of months" [value]="m.value" [selected]="m.value === selectedMonth">
                    {{ m.label }}
                </option>
            </select>
            <button (click)="downloadPdf()">
                ⬇ PDF
            </button>
        </div>
    </div>

    <div *ngIf="isLoading$ | async">
        <div></div>
        <p>Loading financial report...</p>
    </div>

    <div *ngIf="error$ | async as error">
        <h3>Error Loading Report</h3>
        <p>{{ error.message || 'Something went wrong while fetching the financial report.' }}</p>
        <button (click)="fetchData(selectedMonth)">Try Again</button>
    </div>

    <ng-container *ngIf="report$ | async as report">
        <!-- Key Metrics Cards -->
        <div>

            <!-- Revenue -->
            <div>
                <h3>Total Revenue</h3>
                <div>₹{{ report.revenue | number }}</div>
                <div>▲ 12% vs last month</div>
            </div>

            <!-- Expenses -->
            <div>
                <h3>Total Expenses</h3>
                <div>₹{{ report.expenses | number }}</div>
                <div>▼ 5% vs last month</div>
            </div>

            <!-- Net Profit -->
            <div>
                <h3>Net Profit</h3>
                <div>₹{{ report.netProfit | number }}
                </div>
                <div>Margin: {{ (report.netProfit /
                    report.revenue * 100) | number:'1.0-1' }}%</div>
            </div>
        </div>

        <!-- Charts Section -->
        <div>
            <div>
                <h3>CASH FLOW TREND
                </h3>

                <!-- CSS-only Bar Chart -->
                <div>
                    <div *ngFor="let data of report.chartData">
                        <div>
                            <!-- Expense Bar -->
                            <div [style.height.%]="(data.expense / 40000) * 100"></div>
                            <!-- Revenue Bar -->
                            <div [style.height.%]="(data.revenue / 40000) * 100"></div>
                        </div>
                        <span>{{ data.label }}</span>
                    </div>
                </div>

                <!-- Legend -->
                <div>
                    <div>
                        <span></span> Revenue
                    </div>
                    <div>
                        <span></span> Expense
                    </div>
                </div>

            </div>

            <div>
                <h3>EXPENSE BREAKDOWN
                </h3>
                <!-- Pie Chart CSS Placeholder -->
                <div>
                </div>

                <ul>
                    <li>
                        <span>Rent & Utilities</span>
                        <span>40%</span>
                    </li>
                    <li>
                        <span>Staff Salaries</span>
                        <span>35%</span>
                    </li>
                </ul>
            </div>
        </div>
    </ng-container>

</div>